<div class="p-4 md:px-6">
  <p-menubar class="max-w-7xl mx-auto">
    <!-- Gauche : logo + brand -->
    <ng-template pTemplate="start">
      <a class="flex items-center gap-2 no-underline" [routerLink]="['/']">
        <img src="assets/images/koto_logo.png" alt="Koto" class="h-5">
        <span class="font-semibold">KO<span class="font-semibold text-orange-500">TO</span></span>
      </a>
    </ng-template>

    <!-- Droite : selon Ã©tat -->
    <ng-template pTemplate="end">
      @if (isAuth) {
        <div class="flex items-center gap-3">
          <!-- Notifications -->
          <button type="button"
                  class="relative rounded-full px-3 py-1 text-sm hover:bg-white/10 transition"
                  (click)="notifPopover.toggle($event)"
                  aria-label="Notifications">
            <i class="pi pi-bell"></i>
            @if (notifCount > 0) {
              <span class="absolute -top-1 -right-1 text-[10px] leading-none rounded-full bg-orange-500 text-white px-1.5 py-0.5">
                {{ notifCount }}
              </span>
            }
          </button>

          <p-popover #notifPopover>
            <ng-template pTemplate="content">
              <div class="w-72">
                <div class="px-2 py-2 text-sm font-semibold opacity-80">Notifications</div>
                <div class="divide-y divide-white/10">
                  @if (notifications?.length === 0) {
                    <div class="px-3 py-4 text-sm opacity-60">Aucune notification</div>
                  } @else {
                    @for (n of notifications; track n.id) {
                      <div class="px-3 py-2 text-sm">
                        <div>{{ n.text }}</div>
                        <div class="text-xs opacity-60">{{ n.date }}</div>
                      </div>
                    }
                  }
                </div>
              </div>
            </ng-template>
          </p-popover>

          <!-- Menu utilisateur -->
          <p-tieredMenu #userMenu [popup]="true" [model]="userMenuItems" appendTo="body"></p-tieredMenu>

          <!-- Avatar utilisateur -->
          <button class="rounded-full overflow-hidden w-9 h-9 ring-1 ring-white/10"
                  (click)="userMenu.toggle($event)" aria-label="User menu">
            <img src="assets/images/avatar.png" alt="User" class="w-full h-full object-cover">
          </button>
        </div>
      } @else {
        <div class="flex items-center gap-2">
          <a [routerLink]="['/register']"
              class="inline-flex items-center rounded-full bg-orange-500/90 hover:bg-orange-500 text-white text-sm px-3 py-1.5 transition">
            <span class="mr-1">+</span> Register
          </a>
          <a [routerLink]="['/login']"
              class="inline-flex items-center rounded-full text-sm px-3 py-1.5 hover:bg-white/10 transition">
            Login
          </a>
        </div>
      }
    </ng-template>
  </p-menubar>

</div>
